webpackJsonp([0x76eb136f5aa1],{368:function(s,a){s.exports={data:{markdownRemark:{html:'<p>以下是在学习和使用spark过程中遇到的一些问题，记录下来。</p>\n<p>**1. **  首先来说说spark任务运行完后查错最常用的一个命令，那就是把任务运行日志down下来。 程序存在错误，将日志down下来查看具体原因！down日志命令：<code>yarn logs -applicationId app_id</code> </p>\n<p>**2. **  Spark性能优化的9大问题及其解决方案：<a href="http://book.51cto.com/art/201409/453045.htm">http://book.51cto.com/art/201409/453045.htm</a>\nSpark程序优化所需要关注的几个关键点——最主要的是数据序列化和内存优化  </p>\n<p><code>*问题1</code>：reduce task数目不合适\n<code>解决方法</code>：需根据实际情况调节默认配置，调整方式是修改参数spark.default.parallelism。通常，reduce数目设置为core数目的2到3倍。数量太大，造成很多小任务，增加启动任务的开销；数目太少，*任务运行缓慢。</p>\n<p><code>*问题2</code>：shuffle磁盘IO时间长\n<code>解决方法</code>：设置spark.local.dir为多个磁盘，并设置磁盘为IO速度快的磁盘，通过增加IO来优化shuffle性能；</p>\n<p><code>*问题3</code>：map|reduce数量大，造成shuffle小文件数目多\n<code>解决方法</code>：默认情况下shuffle文件数目为map tasks * reduce tasks. 通过设置spark.shuffle.consolidateFiles为true，来合并shuffle中间文件，此时文件数为reduce tasks数目；</p>\n<p><code>*问题4</code>：序列化时间长、结果大\n<code>解决方法</code>：Spark默认使.用JDK.自带的ObjectOutputStream，这种方式产生的结果大、CPU处理时间长，可以通过设置spark.serializer为org.apache.spark.serializer.KryoSerializer。另外如果结果已经很大，可以使用广播变量；\n<code>*问题5</code>：单条记录消耗大\n<code>解决方法</code>：使用mapPartition替换map，mapPartition是对每个Partition进行计算，而map是对partition中的每条记录进行计算；</p>\n<p><code>*问题6</code>：collect输出大量结果时速度慢\n<code>解决方法</code>：collect源码中是把所有的结果以一个Array的方式放在内存中，可以直接输出到分布式?文件系统，然后查看文件系统中的内容；</p>\n<p><code>*问题7</code>：任务执行速度倾斜\n<code>解决方法</code>：如果是数据倾斜，一般是partition key取的不好，可以考虑其它的并行处理方式 ，并在中间加上aggregation操作；如果是Worker倾斜，例如在某些worker上的executor执行缓慢，可以通过设置spark.speculation=true 把那些持续慢的节点去掉；</p>\n<p><code>*问题8</code>：通过多步骤的RDD操作后有很多空任务或者小任务产生\n<code>解决方法</code>：使用coalesce或repartition去减少RDD中partition数量 </p>\n<p><code>*问题9</code>：Spark Streaming吞吐量不高\n<code>解决方法</code>：可以设置spark.streaming.concurrentJobs </p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code><span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">.</span> <span class="token operator">**</span>  intellij idea直接编译spark源码及问题解决<span class="token punctuation">:</span>\n<span class="token template-string"><span class="token string">`*`</span></span> <span class="token punctuation">[</span>http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>blog<span class="token punctuation">.</span>csdn<span class="token punctuation">.</span>net<span class="token operator">/</span>tanglizhe1105<span class="token operator">/</span>article<span class="token operator">/</span>details<span class="token operator">/</span><span class="token number">50530104</span><span class="token punctuation">]</span><span class="token punctuation">(</span>http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>blog<span class="token punctuation">.</span>csdn<span class="token punctuation">.</span>net<span class="token operator">/</span>tanglizhe1105<span class="token operator">/</span>article<span class="token operator">/</span>details<span class="token operator">/</span><span class="token number">50530104</span><span class="token punctuation">)</span>\n<span class="token template-string"><span class="token string">`*`</span></span> <span class="token punctuation">[</span>http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>stackoverflow<span class="token punctuation">.</span>com<span class="token operator">/</span>questions<span class="token operator">/</span><span class="token number">18920334</span><span class="token operator">/</span>output<span class="token operator">-</span>path<span class="token operator">-</span>is<span class="token operator">-</span>shared<span class="token operator">-</span>between<span class="token operator">-</span>the<span class="token operator">-</span>same<span class="token operator">-</span>module<span class="token operator">-</span>error<span class="token punctuation">]</span><span class="token punctuation">(</span>http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>stackoverflow<span class="token punctuation">.</span>com<span class="token operator">/</span>questions<span class="token operator">/</span><span class="token number">18920334</span><span class="token operator">/</span>output<span class="token operator">-</span>path<span class="token operator">-</span>is<span class="token operator">-</span>shared<span class="token operator">-</span>between<span class="token operator">-</span>the<span class="token operator">-</span>same<span class="token operator">-</span>module<span class="token operator">-</span>error<span class="token punctuation">)</span>\n\n<span class="token operator">&lt;</span>figure <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"highlight scala"</span><span class="token operator">></span><span class="token operator">&lt;</span>table<span class="token operator">></span><span class="token operator">&lt;</span>tbody<span class="token operator">></span><span class="token operator">&lt;</span>tr<span class="token operator">></span><span class="token operator">&lt;</span>td <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"gutter"</span><span class="token operator">></span><span class="token operator">&lt;</span>pre<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span><span class="token operator">&lt;</span>td <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"code"</span><span class="token operator">></span><span class="token operator">&lt;</span>pre<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"type"</span><span class="token operator">></span>Spark<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span>编译：clean <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"keyword"</span><span class="token operator">></span><span class="token keyword">package</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span> <span class="token operator">-</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"type"</span><span class="token operator">></span>Dmaven<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span><span class="token punctuation">.</span>test<span class="token punctuation">.</span>skip<span class="token operator">=</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"literal"</span><span class="token operator">></span><span class="token boolean">true</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span>参数：<span class="token operator">-</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"type"</span><span class="token operator">></span>Xmx2g<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span> <span class="token operator">-</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"type"</span><span class="token operator">></span>XX<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span><span class="token punctuation">:</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"type"</span><span class="token operator">></span>MaxPermSize<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">>=</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"number"</span><span class="token operator">></span><span class="token number">512</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span>M <span class="token operator">-</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"type"</span><span class="token operator">></span>XX<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span><span class="token punctuation">:</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"type"</span><span class="token operator">></span>ReservedCodeCacheSize<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">>=</span><span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"number"</span><span class="token operator">></span><span class="token number">512</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span>m<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>tbody<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>table<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>figure<span class="token operator">></span>\n</code></pre>\n      </div>\n<p>**4. **  import Spark source code into intellj, build Error: not found: type SparkFlumeProtocol and EventBatch\n<a href="http://stackoverflow.com/questions/33311794/import-spark-source-code-into-intellj-build-error-not-found-type-sparkflumepr">http://stackoverflow.com/questions/33311794/import-spark-source-code-into-intellj-build-error-not-found-type-sparkflumepr</a>  </p>\n<div align="center">[![1.1](/uploads/spark/spark_complie_config.png)](/uploads/spark/spark_complie_config.png)</div>\n<p>**5. **  java.lang.NoSuchMethodException: java.util.Set.<init>()\n<a href="mailto:http://mail-archives.apache.org/mod_mbox/hive-user/201307.mbox/%3CCE1CA41C.1176E%25rdm@baynote.com%3E">http://mail-archives.apache.org/mod_mbox/hive-user/201307.mbox/%3CCE1CA41C.1176E%25rdm@baynote.com%3E</a> </init></p>\n<p>**6. **  Apache Zeppelin编译安装：<a href="http://www.iteblog.com/archives/1573">http://www.iteblog.com/archives/1573</a>\nApache Zeppelin installation grunt build error：<a href="http://stackoverflow.com/questions/33352309/apache-zeppelin-installation-grunt-build-error?rq=1">http://stackoverflow.com/questions/33352309/apache-zeppelin-installation-grunt-build-error?rq=1</a>\n<code>解决方法</code>：进入web模块npm install</p>\n<p>**7. **  Spark源码编译遇到的问题解决：<a href="http://www.tuicool.com/articles/NBVvai">http://www.tuicool.com/articles/NBVvai</a>\n<code>解决方法</code>：内存不够，这个错误是因为编译的时候内存不够导致的，可以在编译的时候加大内存。</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code><span class="token operator">&lt;</span>figure <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"highlight"</span><span class="token operator">></span><span class="token operator">&lt;</span>table<span class="token operator">></span><span class="token operator">&lt;</span>tbody<span class="token operator">></span><span class="token operator">&lt;</span>tr<span class="token operator">></span><span class="token operator">&lt;</span>td <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"gutter"</span><span class="token operator">></span><span class="token operator">&lt;</span>pre<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token number">3</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token number">4</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token number">5</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token number">6</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token number">7</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token number">8</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token number">9</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token number">10</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span><span class="token operator">&lt;</span>td <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"code"</span><span class="token operator">></span><span class="token operator">&lt;</span>pre<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token punctuation">[</span>ERROR<span class="token punctuation">]</span> PermGen space <span class="token operator">-</span><span class="token operator">&amp;</span>gt<span class="token punctuation">;</span> <span class="token punctuation">[</span>Help <span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token punctuation">[</span>ERROR<span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token punctuation">[</span>ERROR<span class="token punctuation">]</span> To see the full stack trace <span class="token keyword">of</span> the errors<span class="token punctuation">,</span>re<span class="token operator">-</span>run Maven <span class="token keyword">with</span> the <span class="token operator">-</span>e <span class="token keyword">switch</span><span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token punctuation">[</span>ERROR<span class="token punctuation">]</span> Re<span class="token operator">-</span>run Maven using the <span class="token operator">-</span>X <span class="token keyword">switch</span> to enable full debug logging<span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token punctuation">[</span>ERROR<span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token punctuation">[</span>ERROR<span class="token punctuation">]</span> For more information about the errors and possible solutions<span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span>please read the following articles<span class="token punctuation">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token punctuation">[</span>ERROR<span class="token punctuation">]</span> <span class="token punctuation">[</span>Help <span class="token number">1</span><span class="token punctuation">]</span>http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>cwiki<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>org<span class="token operator">/</span>confluence<span class="token operator">/</span>display<span class="token operator">/</span>MAVEN<span class="token operator">/</span>OutOfMemoryError<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"line"</span><span class="token operator">></span><span class="token keyword">export</span> MAVEN_OPTS<span class="token operator">=</span><span class="token string">"-Xmx2g -XX:MaxPermSize=512M -XX:ReservedCodeCacheSize=512m"</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>tbody<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>table<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>figure<span class="token operator">></span>\n</code></pre>\n      </div>\n<p>**8. **  Exception in thread “main” java.lang.UnsatisfiedLinkError: no jnind4j in java.library.path\nI’m using a 64-Bit Java on Windows and still get the no jnind4j in java.library.path error\nIt may be that you have incompatible DLLs on your PATH. In order to tell DL4J to ignore those you have to add the following as a VM parameter (Run -> Edit Configurations -> VM Options in IntelliJ): <code>-Djava.library.path=""</code></p>\n<p>**9. **  <code>spark2.0</code>本地运行源码报错解决办法：</p>\n<div class="gatsby-highlight">\n      <pre class="language-scala"><code>`<span class="token number">1</span><span class="token punctuation">.</span>` 修改对应pom中的依赖jar包，将scope级别由`provided`改为`compile`\n`<span class="token number">2</span><span class="token punctuation">.</span>` 运行类之前，去掉make选项；在运行vm设置中增加`<span class="token operator">-</span>Dspark<span class="token punctuation">.</span>master<span class="token operator">=</span>local`\n`<span class="token number">3</span><span class="token punctuation">.</span>` Win7下运行spark example代码报错：\n`java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>IllegalArgumentException<span class="token operator">:</span> java<span class="token punctuation">.</span>net<span class="token punctuation">.</span>URISyntaxException<span class="token operator">:</span> Relative path in absolute URI<span class="token operator">:</span> file<span class="token operator">:</span>D<span class="token operator">:</span><span class="token operator">/</span>SourceCode<span class="token operator">/</span>spark<span class="token operator">-</span><span class="token number">2.0</span><span class="token punctuation">.</span><span class="token number">0</span><span class="token operator">/</span>spark<span class="token operator">-</span>warehouse`修改SQLConf类中WAREHOUSE_PATH变量，将file<span class="token operator">:</span>前缀改为file<span class="token operator">:</span><span class="token operator">/</span>或file<span class="token operator">:</span><span class="token operator">/</span><span class="token comment">//</span>\ncreateWithDefault<span class="token punctuation">(</span>“file<span class="token operator">:</span><span class="token operator">/</span>$<span class="token punctuation">{</span>system<span class="token operator">:</span>user<span class="token punctuation">.</span>dir<span class="token punctuation">}</span><span class="token operator">/</span>spark<span class="token operator">-</span>warehouse”<span class="token punctuation">)</span>\n`<span class="token number">4</span><span class="token punctuation">.</span>` local模式运行：`<span class="token operator">-</span>Dspark<span class="token punctuation">.</span>master<span class="token operator">=</span>local`\n</code></pre>\n      </div>\n<p>**10. **  解决<code>Task not serializable Exception</code>错误\n方法1：将RDD中的所有数据通过JDBC连接写入数据库，若使用map函数，可能要为每个元素都创建connection，这样开销很大，如果使用mapPartitions，那么只需要针对每个分区建立connection；mapPartitions处理后返回的是Iterator。\n方法2：对未序列化的对象加@transisent引用，在进行网络通信时不对对象中的属性进行序列化</p>\n<p>**11. **  这个函数在func(“11”)调用时候正常,但是在执行func(11)或func(1.1)时候就会报error: type mismatch的错误. 这个问题很好解决</p>\n<p><code>-</code> 针对特定的参数类型, 重载多个func函数,这个不难, 传统JAVA中的思路, 但是需要定义多个函数\n<code>-</code> 使用超类型, 比如使用AnyVal,Any;这样的话比较麻烦,需要在函数中针对特定的逻辑做类型转化,从而进一步处理上面两个方法使用的是传统JAVA思路,虽然都可以解决该问题,但是缺点是不够简洁;在充满了语法糖的Scala中,针对类型转换提供了特有的implicit隐式转化的功能;</p>\n<p>**12. **  org.apache.spark.shuffle.MetadataFetchFailedException: Missing an output location for shuffle\n<code>解决方法</code>：这种问题一般发生在有大量shuffle操作的时候,task不断的failed,然后又重执行，一直循环下去，直到application失败。一般遇到这种问题提高executor内存即可,同时增加每个executor的cpu,这样不会减少task并行度。</p>\n<p>**13. **  Spark ML PipeLine GBT/RF预测时报错，java.util.NoSuchElementException: key not found: 8.0\n<code>错误原因</code>：由于GBT/RF模型输入setFeaturesCol，setLabelCol参数列名不一致导致。\n<code>解决方法</code>：只保存训练算法模型，不保存PipeLineModel</p>\n<p>**14. **  linux删除乱码文件，find . -inum 54263996 -exec rm {} -rf ;</p>\n<p>**15. **  org.apache.spark.SparkException: Exception thrown in awaitResult\n<code>set "spark.sql.broadcastTimeout" to increase the timeout</code></p>\n<p>**16. **  Caused by: java.lang.RuntimeException: Failed to commit task\nCaused by: org.apache.spark.executor.CommitDeniedException: attempt<em>201603251514</em>0218<em>m</em>000245_0: Not committed because the driver did not authorize commit\n如果你比较了解spark中的stage是如何划分的，这个问题就比较简单了。一个Stage中包含的task过大，一般由于你的transform过程太长，因此driver给executor分发的task就会变的很大。所以解决这个问题我们可以通过拆分stage解决。也就是在执行过程中调用cache.count缓存一些中间数据从而切断过长的stage。</p>'},indexJson:{title:"Spark 学习笔记"}},pathContext:{slug:"/posts/7/",pid:7,next:"/posts/8",prev:"/posts/6"}}}});
//# sourceMappingURL=path---posts-7-f6ed77d92a2e941ca489.js.map